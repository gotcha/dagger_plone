python_ctr=$(container | from python:3.12)
buildout_ctr=$(with-buildout $python_ctr)
plone_ctr=$(with-plone $buildout_ctr --plone-version 6.1.0)
plone_srv=$($plone_ctr | as-service --args bin/instance,fg)
cypress_dir=$(git https://github.com/gotcha/dagger_plone | head | tree)
container | from cypress/included | with-directory /app $cypress_dir  | with-workdir /app | with-service-binding plone $plone_srv | with-exec -- cypress run --env PLONE_HOST=plone:8080 -s cypress/e2e/plone* | stdout
